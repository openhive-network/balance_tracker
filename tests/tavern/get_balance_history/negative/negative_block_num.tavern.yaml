---
test_name: btracker PostgREST - Negative Block Values

marks:
  - patterntest
  - negative

includes:
  - !include ../../common.yaml

stages:
  - name: test negative from_block
    request:
      url: "{service.proto:s}://{service.server:s}:{service.port}/rpc/get_balance_history"
      method: POST
      headers:
        content-type: application/json
        accept: application/json
      json:
        account-name: "blocktrades"
        coin-type: "HBD"
        from_block: -5
        to_block: 10
    response:
      status_code: 400
      verify_response_with:
        function: validate_response:compare_rest_response_with_pattern
        extra_kwargs:
          error_response: true
          pattern: negative_zero_block_num.json

  - name: test negative to_block
    request:
      url: "{service.proto:s}://{service.server:s}:{service.port}/rpc/get_balance_history"
      method: POST
      headers:
        content-type: application/json
        accept: application/json
      json:
        account-name: "blocktrades"
        coin-type: "HBD"
        from_block: 10
        to_block: -3
    response:
      status_code: 400
      verify_response_with:
        function: validate_response:compare_rest_response_with_pattern
        extra_kwargs:
          error_response: true
          pattern: negative_zero_block_num.json
